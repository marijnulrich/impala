<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=3, user-scalable=1"
    />
    <title></title>
    <link rel="preconnect" href="https://use.typekit.net" crossorigin />
    <link rel="stylesheet" rel="preload" as="font" href="https://use.typekit.net/.css?v=1738492887" />

    <script src="scormdriver.js" charset="utf-8"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xapiwrapper/1.11.2/xapiwrapper.min.js"></script>

    <script>
      USE_LEGACY_IDENTIFIERS_FOR_2004 = true;
      REVIEW_MODE_IS_READ_ONLY = false;
      window.onbeforeunload = () => window.Unload();

      // Configure Veracity LRS
      var conf = {
        endpoint: "https://github-test.lrs.io/xapi/",
        auth: "Basic " + btoa("vufeve:talvaz"), // Your Veracity LRS credentials
      };
      ADL.XAPIWrapper.changeConfig(conf);

      // Generate a test user email dynamically
      function getTestUser() {
        let randomNum = Math.floor(Math.random() * 10000);
        return `testuser+${randomNum}@example.com`;
      }

      // Function to send xAPI statements
      function sendStatement(verbId, verbDisplay, objectId, objectName) {
        var statement = {
          actor: {
            mbox: "mailto:" + getTestUser(), // Generates a different test email each time
            name: "Test User",
            objectType: "Agent"
          },
          verb: {
            id: verbId,
            display: { "en-US": verbDisplay }
          },
          object: {
            id: objectId,
            definition: {
              name: { "en-US": objectName },
              description: { "en-US": "Tracking activity on the website" }
            },
            objectType: "Activity"
          }
        };

        ADL.XAPIWrapper.sendStatement(statement, function(resp, obj) {
          console.log("âœ… xAPI Statement Sent:", statement, resp);
        });
      }

      // Track page load event
      window.onload = function () {
        Start(); // Existing function
        sendStatement(
          "http://adlnet.gov/expapi/verbs/viewed",
          "viewed",
          "http://your-site-url.com",
          "Website Homepage"
        );
      };

      // Modify LoadContent function to ensure proper script loading
      const LoadContent = function () {
        [
          "assets/js/project.js",
          "dist/main.chunk.js",
          "dist/runtime-main.bundle.js",
          "dist/vendors-main.chunk.js",
        ].forEach((src) => {
          let script = document.createElement("script");
          script.src = src;
          script.charset = "utf-8";
          script.async = false;
          document.body.appendChild(script);
        });
      };
    </script>
  </head>
  <body>
    <div id="app" style="width: 100%; height: 100%"></div>
  </body>
</html>